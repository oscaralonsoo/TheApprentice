#include "InvulnerabilitySystem.h"
#include "Player.h"
#include "Engine.h"
#include "Render.h"

void InvulnerabilitySystem::Init(Player* player) {
    this->player = player;
}

void InvulnerabilitySystem::Update(float dt) {
    if (!isInvulnerable)
        return;

    if (invulnerabilityTimer.ReadSec() >= invulnerabilityDuration) {
        isInvulnerable = false;
        visible = true;
    }
    else {
        if (blinkTimer.ReadMSec() >= blinkInterval) {
            visible = !visible; // cambiar visibilidad
            blinkTimer.Start();
            blinkInterval += 150.0f; // parpadeo m√°s lento
        }
    }
}

void InvulnerabilitySystem::StartInvulnerability() {
    isInvulnerable = true;
    visible = true;
    invulnerabilityTimer.Start();
    blinkTimer.Start();
    blinkInterval = 150.0f;
}

bool InvulnerabilitySystem::IsInvulnerable() const {
    return isInvulnerable;
}

bool InvulnerabilitySystem::IsVisible() const {
    return visible;
}
